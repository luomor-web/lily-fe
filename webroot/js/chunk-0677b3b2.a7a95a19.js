(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0677b3b2"],{"561b":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("WaterMark",[e("Header",{attrs:{back:""}}),e("Card",{attrs:{"dis-hover":"",bordered:!1,title:"装修信息"}},[e("Row",{staticClass:"detail-row"},[e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v("小区名称")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t.community_name))])]),e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v("装修房产")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t._f("building")(t.detail.info,!1)))])]),e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v("申请时间")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t._f("mom_format")(t.detail.info.created_at)))])]),e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 业主姓名 ")]),e("div",{staticClass:"detail-content"},[t.userInfo.access.includes(t.ROLES.YZDA)?e("router-link",{attrs:{to:"/basic/owner/detail/"+t.detail.info.wechat_mp_user_id}},[t._v(" "+t._s(t.detail.info.real_name)+" ")]):e("span",[t._v(t._s(t.detail.info.real_name))])],1)]),e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 当前进度 ")]),e("div",{staticClass:"detail-content"},[e("Tag",{attrs:{color:t.progress.color}},[t._v(t._s(t.progress.text))])],1)]),e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 装修保证金 ")]),e("div",{staticClass:"detail-content"},[e("Tag",{attrs:{color:t.detail.info.fitment_pledge?"magenta":"default"}},[t._v(" "+t._s(t.detail.info.fitment_pledge?"需要":"不需要")+" ")])],1)]),t.detail.info.fitment_pledge&&t.detail.info.step>=2?e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 保证金额 ")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t._f("yuan")(t.detail.info.cash_deposit))+"（元）")])]):t._e(),t.detail.info.fitment_pledge&&t.detail.info.step>=2?e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 返款银行 ")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t.detail.info.return_bank))])]):t._e(),t.detail.info.fitment_pledge&&t.detail.info.step>=2?e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 返款账户 ")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t.detail.info.return_name))])]):t._e(),t.detail.info.fitment_pledge&&t.detail.info.step>=2?e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 返款账号 ")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t.detail.info.return_bank_id))])]):t._e(),t.detail.info.step>=3?e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 完工时间 ")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t._f("mom_format")(t.detail.info.finished_at)))])]):t._e()],1)],1),1===t.detail.info.step?e("Card",{staticClass:"mt-16",attrs:{"dis-hover":"",bordered:!1,title:"准许审批"}},[t.detail.info.fitment_pledge?e("Form",{ref:"form",attrs:{model:t.form,"label-position":t.mlabelPostion,"label-width":t.mlabelWidth,rules:t.rules},nativeOn:{submit:function(t){t.preventDefault()}}},[e("FormField",{attrs:{title:"保证金金额：",prop:"cash_deposit",unit:"分",label:t.form.cash_deposit?t.yuan:""}},[e("Input",{attrs:{type:"number",placeholder:"请输入保证金金额"},model:{value:t.form.cash_deposit,callback:function(e){t.$set(t.form,"cash_deposit",e)},expression:"form.cash_deposit"}})],1),e("FormField",{attrs:{title:"返款账户：",prop:"return_name"}},[e("Input",{attrs:{placeholder:"请输入返款账户"},model:{value:t.form.return_name,callback:function(e){t.$set(t.form,"return_name",e)},expression:"form.return_name"}})],1),e("FormField",{attrs:{title:"返款银行：",prop:"return_bank"}},[e("Input",{attrs:{placeholder:"请输入返款银行"},model:{value:t.form.return_bank,callback:function(e){t.$set(t.form,"return_bank",e)},expression:"form.return_bank"}})],1),e("FormField",{attrs:{title:"返款账号：",prop:"return_bank_id"}},[e("Input",{attrs:{placeholder:"请输入返款账号"},model:{value:t.form.return_bank_id,callback:function(e){t.$set(t.form,"return_bank_id",e)},expression:"form.return_bank_id"}})],1)],1):t._e(),e("div",{staticClass:"cw-form-actions"},[e("Button",{attrs:{type:"primary",loading:t.submiting},on:{click:t.agree}},[t._v("同意装修")])],1)],1):t._e(),3===t.detail.info.step?e("Card",{staticClass:"mt-16",attrs:{"dis-hover":"",bordered:!1,title:"装修完工验收"}},[e("div",{staticClass:"cw-form-actions"},[e("Button",{attrs:{type:"primary",loading:t.confirming},on:{click:t.confirm}},[t._v("验收合格")])],1)]):t._e(),t.detail.info.step>=2?e("Card",{staticClass:"mt-16",attrs:{"dis-hover":"",bordered:!1,title:"许可装修审批信息"}},[e("Row",{staticClass:"detail-row"},[e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v("同意时间")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t._f("mom_format")(t.detail.info.agreed_at)))])]),e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 同意审批人 ")]),e("div",{staticClass:"detail-content"},[e("router-link",{attrs:{to:"/oa/hr/colleague/detail/"+t.detail.agreeUserInfo.id}},[t._v(" "+t._s(t.detail.agreeUserInfo.real_name)+" ")])],1)])],1)],1):t._e(),4===t.detail.info.step?e("Card",{staticClass:"mt-16",attrs:{"dis-hover":"",bordered:!1,title:"物业验收审批信息"}},[e("Row",{staticClass:"detail-row"},[e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v("确认时间")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t._f("mom_format")(t.detail.info.confirmed_at)))])]),e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 确认审批人 ")]),e("div",{staticClass:"detail-content"},[e("router-link",{attrs:{to:"/oa/hr/colleague/detail/"+t.detail.confirmUserInfo.id}},[t._v(" "+t._s(t.detail.confirmUserInfo.real_name)+" ")])],1)])],1)],1):t._e(),4===t.detail.info.step&&t.detail.info.is_return_cash_deposit&&t.detail.info.fitment_pledge?e("Card",{staticClass:"mt-16",attrs:{"dis-hover":"",bordered:!1,title:"返还装修保证金审批信息"}},[e("Row",{staticClass:"detail-row"},[e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v("返款时间")]),e("div",{staticClass:"detail-content"},[t._v(t._s(t._f("mom_format")(t.detail.returned_at)))])]),e("Col",{attrs:{lg:8,sm:12,xs:24}},[e("span",{staticClass:"detail-label"},[t._v(" 返款审批人 ")]),e("div",{staticClass:"detail-content"},[e("router-link",{attrs:{to:"/oa/hr/colleague/detail/"+t.detail.reutrnUserInfo.id}},[t._v(" "+t._s(t.detail.reutrnUserInfo.real_name)+" ")])],1)])],1)],1):t._e(),4===t.detail.info.step&&t.detail.info.fitment_pledge&&!t.detail.info.is_return_cash_deposit?e("Card",{staticClass:"mt-16",attrs:{"dis-hover":"",bordered:!1,title:"确认返还装修保证金"}},[e("div",{staticClass:"cw-form-actions"},[e("Button",{attrs:{type:"primary",loading:t.returning},on:{click:t.doReturn}},[t._v("确认返还")])],1)]):t._e(),t.fetching?e("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},i=[],o=s("e7c9"),l=s("88bd"),r=s("545e"),n=s("c03a"),d=s("be5e"),c=s("9484"),m=s("4d77"),u=s("3e79"),f=s("8c99"),h=s("7736"),_=s("2af9"),p=s("ed08"),g=s("0373"),b=s.n(g),C=s("e49c"),v={name:"BasicFitmentDetail",data(){return{ROLES:b.a,fetching:!0,detail:{info:{},agreeUserInfo:null,confirmUserInfo:null,reutrnUserInfo:null},submiting:!1,form:{cash_deposit:"",return_bank:"",return_bank_id:"",return_name:""},rules:{cash_deposit:[{required:!0,message:"请输入保证金金额"},{pattern:/^\d+$/,message:"请输入正确的金额，不能包含小数"}],return_name:[{required:!0,message:"请输入返款账户"},{max:12,message:"返款账户最多输入12个字"}],return_bank:[{required:!0,message:"请输入返款银行"},{max:20,message:"返款银行最多输入20个字"}],return_bank_id:[{required:!0,message:"请输入返款账号"},{max:30,message:"返款账号最多输入20个字"}]},confirming:!1,returning:!1}},mixins:[C["a"]],mounted(){this.postInfo.default_community_id&&this.getDetail()},methods:{getDetail(){const t={id:this.$route.params.id,community_id:this.postInfo.default_community_id};this.fetching=!0,p["i"].post("/fitment/detail",t).then(t=>{this.fetching=!1,this.detail=t.data}).catch(()=>this.fetching=!1)},agree(){const t=t=>{this.submiting=!0;const e={...t,id:this.$route.params.id,community_id:this.postInfo.default_community_id};p["i"].post("/fitment/agree",e).then(t=>{this.submiting=!1,this.detail.agreeUserInfo=t.data.agreeUserInfo,this.detail.info={...this.detail.info,agreed_at:t.data.agreed_at,...this.form,step:2},f["a"].success("准许装修审批成功")}).catch(()=>this.submiting=!1)};if(!this.detail.info.fitment_pledge)return t({});this.$refs.form.validate(e=>{e&&t(this.form)})},confirm(){this.confirming=!0;const t={id:this.$route.params.id,community_id:this.postInfo.default_community_id};p["i"].post("/fitment/confirm",t).then(t=>{this.confirming=!1,this.detail.confirmUserInfo=t.data.confirmUserInfo,this.detail.info={...this.detail.info,confirmed_at:t.data.confirmed_at,step:4},f["a"].success("装修验收合格成功")}).catch(()=>this.confirming=!1)},doReturn(){this.returning=!0;const t={id:this.$route.params.id,community_id:this.postInfo.default_community_id};p["i"].post("/fitment/return",t).then(t=>{this.returning=!1,this.detail.reutrnUserInfo=t.data.reutrnUserInfo,this.detail.info={...this.detail.info,returned_at:t.data.returned_at,is_return_cash_deposit:1},f["a"].success("确认返还装修保证金成功")}).catch(()=>this.returning=!1)}},computed:{...Object(h["c"])({postInfo:"common/postInfo",userInfo:"common/userInfo"}),progress(){let t="",e="";switch(this.detail.info.step){case 1:t="业主申请",e="geekblue";break;case 2:t="准许装修",e="purple";break;case 3:t="装修完工",e="orange";break;case 4:t="物业确认",e="green";break}return{text:t,color:e}},yuan(){return p["h"].yuan(this.form.cash_deposit)+"元"},community_name(){if(!this.postInfo.default_community_id)return"";const t=this.postInfo.community_list.findIndex(t=>t.community_id===this.postInfo.default_community_id);return this.postInfo.community_list[t].name}},watch:{"postInfo.default_community_id"(){this.getDetail()},"$route.params.id"(){this.getDetail()}},components:{Card:u["a"],Spin:m["a"],Header:_["k"],Row:c["a"],Col:d["a"],Tag:n["a"],FormField:_["j"],Form:r["a"],Button:l["a"],Input:o["a"],WaterMark:_["s"]}},y=v,k=s("e607"),x=Object(k["a"])(y,a,i,!1,null,null,null);e["default"]=x.exports},c03a:function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;return t.fade?e("transition",{attrs:{name:"fade"}},[e("div",{class:t.classes,style:t.wraperStyles,on:{click:function(e){return e.stopPropagation(),t.check.apply(null,arguments)}}},[t.showDot?e("span",{class:t.dotClasses,style:t.bgColorStyle}):t._e(),e("span",{class:t.textClasses,style:t.textColorStyle},[t._t("default")],2),t.closable?e("Icon",{class:t.iconClass,attrs:{color:t.lineColor,type:"ios-close"},nativeOn:{click:function(e){return e.stopPropagation(),t.close.apply(null,arguments)}}}):t._e()],1)]):e("div",{class:t.classes,style:t.wraperStyles,on:{click:function(e){return e.stopPropagation(),t.check.apply(null,arguments)}}},[t.showDot?e("span",{class:t.dotClasses,style:t.bgColorStyle}):t._e(),e("span",{class:t.textClasses,style:t.textColorStyle},[t._t("default")],2),t.closable?e("Icon",{class:t.iconClass,attrs:{color:t.lineColor,type:"ios-close"},nativeOn:{click:function(e){return e.stopPropagation(),t.close.apply(null,arguments)}}}):t._e()],1)},i=[],o=s("4b1c"),l=s("e4a4");const r="ivu-tag",n=["default","primary","success","warning","error","blue","green","red","yellow","pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],d=["pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"];var c={name:"Tag",components:{Icon:o["a"]},props:{closable:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},checked:{type:Boolean,default:!0},color:{type:String,default:"default"},type:{validator(t){return Object(l["m"])(t,["border","dot"])}},name:{type:[String,Number]},fade:{type:Boolean,default:!0},size:{validator(t){return Object(l["m"])(t,["default","medium","large"])},default:"default"}},data(){return{isChecked:this.checked}},computed:{classes(){return[""+r,`${r}-size-${this.size}`,{[`${r}-${this.color}`]:!!this.color&&Object(l["m"])(this.color,n),[`${r}-${this.type}`]:!!this.type,[r+"-closable"]:this.closable,[r+"-checked"]:this.isChecked}]},wraperStyles(){return Object(l["m"])(this.color,n)?{}:{background:this.isChecked?this.defaultTypeColor:"transparent",borderWidth:"1px",borderStyle:"solid",borderColor:"dot"!==this.type&&"border"!==this.type&&this.isChecked?this.borderColor:this.lineColor,color:this.lineColor}},textClasses(){return[r+"-text","border"===this.type&&Object(l["m"])(this.color,n)?`${r}-color-${this.color}`:"","dot"!==this.type&&"border"!==this.type&&"default"!==this.color&&this.isChecked&&d.indexOf(this.color)<0?r+"-color-white":""]},dotClasses(){return r+"-dot-inner"},iconClass(){return"dot"===this.type?"":"border"===this.type?Object(l["m"])(this.color,n)?`${r}-color-${this.color}`:"":void 0!==this.color?"default"===this.color?"":"rgb(255, 255, 255)":""},showDot(){return!!this.type&&"dot"===this.type},lineColor(){return"dot"===this.type?"":"border"===this.type?void 0!==this.color?Object(l["m"])(this.color,n)?"":this.color:"":void 0!==this.color?"default"===this.color?"":"rgb(255, 255, 255)":""},borderColor(){return void 0!==this.color?"default"===this.color?"":this.color:""},dotColor(){return void 0!==this.color?Object(l["m"])(this.color,n)?"":this.color:""},textColorStyle(){return Object(l["m"])(this.color,n)?{}:"dot"!==this.type&&"border"!==this.type?this.isChecked?{color:this.lineColor}:{}:{color:this.lineColor}},bgColorStyle(){return Object(l["m"])(this.color,n)?{}:{background:this.dotColor}},defaultTypeColor(){return"dot"!==this.type&&"border"!==this.type&&void 0!==this.color?Object(l["m"])(this.color,n)?"":this.color:""}},methods:{close(t){void 0===this.name?this.$emit("on-close",t):this.$emit("on-close",t,this.name)},check(){if(!this.checkable)return;const t=!this.isChecked;this.isChecked=t,void 0===this.name?this.$emit("on-change",t):this.$emit("on-change",t,this.name)}},watch:{checked(t){this.isChecked=t}}},m=c,u=s("e607"),f=Object(u["a"])(m,a,i,!1,null,null,null),h=f.exports;e["a"]=h}}]);