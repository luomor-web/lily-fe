(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04b77822"],{"3edc":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t._self._c;return e("WaterMark",[e("Header",{attrs:{back:""}}),e("Editor",{attrs:{onSubmit:t.submit,update:"",detail:t.detail}}),t.fetching?e("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},s=[],a=i("4d77"),r=i("8c99"),l=(i("ed70"),i("7736")),n=i("2af9"),u=i("7b77"),m=i("ed08"),c={name:"OaPartyUpdate",components:{Header:n["k"],Editor:u["a"],Message:r["a"],Spin:a["a"],WaterMark:n["s"]},data(){return{fetching:!0,detail:{}}},mounted(){this.getDetail()},methods:{getDetail(){m["i"].get("/party/detail/"+this.$route.params.id).then(t=>{this.fetching=!1,this.detail=t.data}).catch(()=>this.fetching=!1)},submit(t){return new Promise((e,i)=>{t.id=this.$route.params.id,t.community_id=this.postInfo.default_community_id,m["i"].post("/party/update",t).then(()=>{r["a"].success("更新党建党讯成功"),this.$router.push("/oa/party/detail/"+this.$route.params.id),e()}).catch(()=>i())})}},computed:{...Object(l["c"])({postInfo:"common/postInfo"})}},d=c,p=i("e607"),h=Object(p["a"])(d,o,s,!1,null,null,null);e["default"]=h.exports},"7b77":function(t,e,i){"use strict";var o=function(){var t=this,e=t._self._c;return e("Card",{attrs:{"dis-hover":"",bordered:!1}},[e("Form",{ref:"form",staticClass:"form",attrs:{model:t.form,rules:t.rules,"label-position":t.mlabelPostion,"label-width":t.mlabelWidth},nativeOn:{submit:function(t){t.preventDefault()}}},[e("FormField",{attrs:{title:"文章来源："}},[t._v(t._s(t.community_name)+"小区")]),e("FormField",{attrs:{prop:"title",title:"文章标题："}},[e("Input",{attrs:{placeholder:"请输入文章标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),e("FormField",{attrs:{title:"推送首页：",prop:"carousel"}},[e("OSwitch",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.carousel,callback:function(e){t.$set(t.form,"carousel",e)},expression:"form.carousel"}},[e("span",{attrs:{slot:"open"},slot:"open"},[t._v("否")]),e("span",{attrs:{slot:"close"},slot:"close"},[t._v("是")])])],1),t.form.carousel?e("FormField",{attrs:{title:"封面图片：",prop:"cover_img",label:"请上传1200*712像素图片"}},[e("ImageUpload",{attrs:{dir:"party",width:1200,height:712},model:{value:t.form.cover_img,callback:function(e){t.$set(t.form,"cover_img",e)},expression:"form.cover_img"}})],1):t._e(),e("FormField",{attrs:{title:"发布：",prop:"published"}},[e("OSwitch",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.published,callback:function(e){t.$set(t.form,"published",e)},expression:"form.published"}},[e("span",{attrs:{slot:"open"},slot:"open"},[t._v("否")]),e("span",{attrs:{slot:"close"},slot:"close"},[t._v("是")])])],1),e("FormField",{attrs:{prop:"content",title:"文章内容："}},[e("Editor",{attrs:{dir:"party"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),e("div",{staticClass:"cw-form-actions"},[e("Button",{attrs:{type:"primary",loading:t.submiting},on:{click:t.submit}},[t._v(" "+t._s(t.update?"更新":"发布")+" ")])],1)],1)],1)},s=[],a=i("37a2"),r=i("88bd"),l=i("e7c9"),n=i("545e"),u=i("3e79"),m=i("2af9"),c=i("e49c"),d=i("7736"),p={name:"PartyEditor",props:{update:Boolean,onSubmit:Function,detail:{type:Object,default:()=>({})}},data(){return{labelWidth:160,form:{title:this.detail.title?this.detail.title:"",carousel:this.detail.carousel?this.detail.carousel:0,cover_img:this.detail.cover_img?this.detail.cover_img:"",published:this.detail.published?this.detail.published:0,content:this.detail.content?this.detail.content:[]},rules:{title:[{required:!0,message:"请输入文章标题"},{max:56,message:"文章标题不能超过56个字"}],cover_img:[{required:!0,message:"请上传封面图片"}],carousel:[{required:!0,type:"number",message:"请选择是否推送首页"}],published:[{required:!0,type:"number",message:"请选择是否发布文章"}],content:[{required:!0,message:"请输入文章内容",type:"array"}]},submiting:!1}},mixins:[c["a"]],methods:{submit(){this.$refs.form.validate(t=>{t&&(this.submiting=!0,this.onSubmit(this.form).then(()=>{this.submiting=!1},()=>{this.submiting=!1}))})}},computed:{...Object(d["c"])({postInfo:"common/postInfo"}),community_name(){if(!this.postInfo.default_community_id)return"";const t=this.postInfo.community_list.findIndex(t=>t.community_id===this.postInfo.default_community_id);return this.postInfo.community_list[t].name}},watch:{detail:{deep:!0,handler(t){this.form={title:t.title?t.title:"",carousel:t.carousel?t.carousel:0,cover_img:t.cover_img?t.cover_img:"",published:t.published?t.published:0,content:t.content?t.content:[]}}}},components:{Card:u["a"],Form:n["a"],FormField:m["j"],Input:l["a"],Button:r["a"],Editor:m["e"],OSwitch:a["a"],ImageUpload:m["l"]}},h=p,f=i("e607"),b=Object(f["a"])(h,o,s,!1,null,null,null);e["a"]=b.exports}}]);