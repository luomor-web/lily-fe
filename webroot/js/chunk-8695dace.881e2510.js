(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8695dace"],{2310:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("WaterMark",[t("Card",{attrs:{"dis-hover":"",bordered:!1}},[e.disabled?t("Alert",{attrs:{"show-icon":"",type:"error"}},[e._v("禁止自己修改自己的人事信息！")]):e._e(),t("Form",{ref:"form",staticClass:"form",attrs:{model:e.form,rules:e.rules,"label-position":e.mlabelPostion,"label-width":e.mlabelWidth},nativeOn:{submit:function(e){e.preventDefault()}}},[t("FormField",{attrs:{title:"登录账号：",prop:"account",width:"300"}},[t("Input",{attrs:{placeholder:"请输入账号",readonly:e.update},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1),e.update?e._e():t("FormField",{attrs:{title:"登录密码：",prop:"password",width:"300"}},[t("Input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e.update?e._e():t("FormField",{attrs:{title:"确认登录密码：",prop:"password2",width:"300"}},[t("Input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.form.password2,callback:function(t){e.$set(e.form,"password2",t)},expression:"form.password2"}})],1),t("FormField",{attrs:{prop:"real_name",title:"姓名：",width:"200"}},[t("Input",{attrs:{placeholder:"请输入您的真实姓名"},model:{value:e.form.real_name,callback:function(t){e.$set(e.form,"real_name",t)},expression:"form.real_name"}})],1),t("FormField",{attrs:{title:"身份证号码：",prop:"idcard",width:"300"}},[t("Input",{attrs:{placeholder:"请输入您的身份证号码"},model:{value:e.form.idcard,callback:function(t){e.$set(e.form,"idcard",t)},expression:"form.idcard"}})],1),t("FormField",{attrs:{prop:"avatar_url",title:"头像：",label:"请上传200*200以上尺寸图片"}},[t("AvatarCrop",{attrs:{dir:"avatar",circle:""},model:{value:e.form.avatar_url,callback:function(t){e.$set(e.form,"avatar_url",t)},expression:"form.avatar_url"}})],1),t("FormField",{attrs:{title:"手机号码：",prop:"phone",width:"200"}},[t("Input",{attrs:{placeholder:"请输入您的手机号码"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("FormField",{attrs:{title:"任职部门：",prop:"department_id",width:"200"}},[t("Select",{attrs:{placeholder:"请选择任职部门",filterable:""},model:{value:e.form.department_id,callback:function(t){e.$set(e.form,"department_id",t)},expression:"form.department_id"}},e._l(e.options.department,(function(a){return t("Option",{key:a.id,attrs:{value:a.id}},[e._v(" "+e._s(a.name)+" ")])})),1)],1),t("FormField",{attrs:{title:"任职岗位：",prop:"job_id",width:"200"}},[t("Select",{attrs:{placeholder:"请选择任职岗位",filterable:""},model:{value:e.form.job_id,callback:function(t){e.$set(e.form,"job_id",t)},expression:"form.job_id"}},[e._l(e.options.job,(function(a){return[a.parent_id===e.form.department_id?t("Option",{key:a.id,attrs:{value:a.id}},[e._v(" "+e._s(a.name)+" ")]):e._e()]}))],2)],1),t("FormField",{attrs:{title:"访问小区：",prop:"community_access",width:"300"}},[t("Select",{attrs:{placeholder:"请选择可访问小区",multiple:"",filterable:""},model:{value:e.form.community_access,callback:function(t){e.$set(e.form,"community_access",t)},expression:"form.community_access"}},e._l(e.postInfo.community_list,(function(a){return t("Option",{key:a.community_id,attrs:{value:a.community_id}},[e._v(" "+e._s(a.name)+" ")])})),1)],1),t("FormField",{attrs:{title:"访问权限：",prop:"access_id",width:"200"}},[t("Select",{attrs:{placeholder:"请选择访问权限",filterable:""},model:{value:e.form.access_id,callback:function(t){e.$set(e.form,"access_id",t)},expression:"form.access_id"}},e._l(e.options.access,(function(a){return t("Option",{key:a.id,attrs:{value:a.id}},[e._v(" "+e._s(a.name)+" ")])})),1)],1),t("div",{staticClass:"cw-form-actions"},[t("Button",{attrs:{type:"primary",loading:e.submiting,disabled:e.disabled},on:{click:e.submit}},[e._v(" "+e._s(e.update?"修改人事信息":"创建人事信息")+" ")])],1)],1)],1),e.fetching||e.getting?t("Spin",{attrs:{size:"large",fix:""}}):e._e()],1)},s=[],o=a("4c91"),i=a("4d77"),d=a("13ab"),n=a("fee1"),c=a("88bd"),l=a("e7c9"),m=a("545e"),u=a("3e79"),p=(a("00e5"),a("7736")),_=a("2af9"),f=a("ed08"),h=a("e49c"),b={name:"HrEditor",props:{detail:{type:Object,default:()=>({})},update:Boolean,onSubmit:Function,fetching:Boolean},data(){const{detail:e}=this;return{getting:!0,labelWidth:140,options:{department:[],job:[],access:[]},form:{account:e.account?e.account:"",password:void 0,password2:void 0,real_name:e.real_name?e.real_name:"",idcard:e.idcard?e.idcard:void 0,avatar_url:e.avatar_url?e.avatar_url:void 0,phone:e.phone?e.phone:void 0,department_id:e.department_id?e.department_id:void 0,job_id:e.job_id?e.job_id:void 0,community_access:e.community_access?e.community_access:[],access_id:e.access_id?e.access_id:void 0},rules:{account:[{required:!0,message:"请输入账号"},{min:4,message:"账号长度应大于4个字符"}],password:[{required:!0,message:"请输入密码"},{min:6,message:"密码长度应大于6个字符"}],password2:[{required:!0,message:"请输入确认密码"},{min:6,message:"密码长度应大于6个字符"},{validator:(e,t,a)=>{t&&this.form.password&&t===this.form.password?a():a(new Error("两次密码输入不一致"))},message:"两次密码输入不一致"}],real_name:[{required:!0,message:"请输入您的真实姓名"},{max:8,message:"姓名不能超过8个字符"}],idcard:[{required:!0,message:"请输入您的身份证号码"},{pattern:/^\d{17}\d|x$/i,message:"请输入正确的身份证号码"}],avatar_url:[{required:!0,message:"请上传您的头像，建议使用实拍照片"}],phone:[{required:!0,message:"请输入您的手机号码"},{pattern:/^\d{11}$/,message:"请输入正确的手机号码"}],department_id:[{required:!0,type:"number",message:"请选择任职部门"}],job_id:[{required:!0,type:"number",message:"请选择任职岗位"}],community_access:[{required:!0,type:"array",message:"请选择可访问的小区"}],access_id:[{required:!0,type:"number",message:"请选择访问权限"}]},submiting:!1}},mixins:[h["a"]],mounted(){f["i"].get("/hr/assign").then(e=>{this.getting=!1,this.options=e.data})},methods:{submit(){this.$refs.form.validate(e=>{if(!e)return;const t={...this.form};delete t.password2,this.update&&(delete t.account,delete t.password),this.submiting=!0,this.onSubmit(t).then(()=>{this.submiting=!1},()=>{this.submiting=!1})})}},watch:{detail:{deep:!0,handler(e){this.form={account:e.account?e.account:"",password:void 0,password2:void 0,real_name:e.real_name?e.real_name:"",idcard:e.idcard?e.idcard:void 0,avatar_url:e.avatar_url?e.avatar_url:void 0,phone:e.phone?e.phone:void 0,department_id:e.department_id?e.department_id:void 0,job_id:e.job_id?e.job_id:void 0,community_access:e.community_access?e.community_access:[],access_id:e.access_id?e.access_id:void 0}}}},computed:{...Object(p["c"])({postInfo:"common/postInfo",userInfo:"common/userInfo"}),disabled(){return!!this.detail.id&&this.detail.id===this.userInfo.id}},components:{Card:u["a"],AvatarCrop:_["b"],Form:m["a"],FormField:_["j"],Input:l["a"],Button:c["a"],Select:n["a"],Option:d["a"],Spin:i["a"],Alert:o["a"],WaterMark:_["s"]}},v=b,w=a("e607"),g=Object(w["a"])(v,r,s,!1,null,null,null);t["a"]=g.exports},d2bd:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("section",[t("Header"),e.msg?t("Alert",{attrs:{"show-icon":"",type:"error"}},[e._v(" "+e._s(e.msg)+" ")]):e._e(),t("Editor",{attrs:{onSubmit:e.submit}})],1)},s=[],o=a("4c91"),i=a("8c99"),d=(a("ed70"),a("2af9")),n=a("2310"),c=a("ed08"),l={name:"OaHrJoin",components:{Header:d["k"],Editor:n["a"],Message:i["a"],Alert:o["a"]},data(){return{msg:null}},methods:{submit(e){return new Promise((t,a)=>{const{code:r,state:s}=this.$route.query;e.code=r,e.state=s,c["i"].post("/hr/create",e).then(e=>{i["a"].success("人事信息创建成功"),this.$router.push("/oa/hr/detail/"+e.data.id),t()}).catch(e=>{this.msg=e.message,a()})})}}},m=l,u=a("e607"),p=Object(u["a"])(m,r,s,!1,null,null,null);t["default"]=p.exports}}]);